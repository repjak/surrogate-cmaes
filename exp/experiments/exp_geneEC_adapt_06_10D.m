exp_id = 'exp_geneEC_adapt_06_10D';
exp_description = 'Surrogate CMA-ES model using generation EC with generation number dependant on model''s log-scaled Kendall coefficient, varying updateRate, maxModelGenerations and error transfer function';

% BBOB/COCO framework settings

bbobParams = { ...
  'dimensions',        { 2, 3, 5, 10 }, ...
  'functions',        num2cell(1:24), ...
  'opt_function',     { @opt_s_cmaes }, ...
  'instances',        { [1:5, 41:50] }, ...
  'maxfunevals',      { '300 * dim' }, ...
};

% Surrogate manager parameters

surrogateParams = { ...
  'evoControl',                    { 'generation' }, ...
  'modelType',                     { 'fitrgp' }, ...           % 'gp', 'rf', 'bbob'
  'evoControlPreSampleSize',       { 0 }, ...              % {0.25, 0.5, 0.75}, will be multip. by lambda
  'evoControlIndividualExtension', { 100 }, ...            % will be multip. by lambda
  'evoControlBestFromExtension',   { 0.2 }, ...            % ratio of expanded popul.
  'evoControlTrainRange',          { 8 }, ...              % will be multip. by sigma
  'evoControlTrainNArchivePoints', { '15*dim' }, ...       % will be myeval()'ed, 'nRequired', 'nEvaluated', 'lambda', 'dim' can be used
  'evoControlSampleRange',         { 1 }, ...              % will be multip. by sigma
  'evoControlValidatePoints',      { [] }, ...
  'updaterParams',                 { ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.8 ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.8 ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.2 ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.2 ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.8, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig((10^x-1)/9, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.8, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig((10^x-1)/9, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.2, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig((10^x-1)/9, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.2, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig((10^x-1)/9, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.8, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig(x, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.8, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig(x, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 10, ...
									   'updateRate', 0.2, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig(x, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'rmseKendall', ...
									   'alpha', 1, ...
                                       'minModelGenerations', 0, ...
                                       'maxModelGenerations', 20, ...
									   'updateRate', 0.2, ...
									   'transferFun', @(x) GenerationsUpdaterRMSEKendall.simplesig(x, 2) ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'constant', ...
                                       'origGenerations', 1, ...
                                       'modelGenerations', 1 ...
                                     ), ...
                                     struct( ...
                                       'updaterType', 'constant', ...
                                       'origGenerations', 1, ...
                                       'modelGenerations', 5 ...
                                     ), ...
                                   }, ...
};

% Model parameters

modelParams = { ...
  'useShift',           { false }, ...
  'cov',                     { struct( ...                                   % settings we used with gpml
                                 'fcn', '@GenerationsUpdaterRMSEKendall.covFcn', ...
                                 'sigma', 0.001, ...
                                 'hyp', 'log([0.5 * ones(dim, 1); 0.1; 0.1; 1e-4])' ...
                               ) ...
							 }, ...
  'normalizeX',         { true }, ...
  'normalizeY',         { true }, ...
};

% CMA-ES parameters

cmaesParams = { ...
  'PopSize',            { '(4 + floor(3*log(N)))' }, ...
  'ParentNumber',       { 'floor(popsize/2)' }, ...
  'Restarts',           { 4 }, ...
};

logDir = '/storage/plzen1/home/repjak/public';
